
<!-- saved from url=(0106)file:///Users/hanspeide/projects/Chromecast/Cast-Media-Player-Library-Sample/MediaPlayerLibrarySample.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></head><body><div class="webkit-line-gutter-backdrop"></div><table><tbody><tr><td class="webkit-line-number" value="1"></td><td class="webkit-line-content"><span class="webkit-html-comment">&lt;!-- </span></td></tr><tr><td class="webkit-line-number" value="2"></td><td class="webkit-line-content"><span class="webkit-html-comment">Copyright 2014 Google Inc. All Rights Reserved.</span></td></tr><tr><td class="webkit-line-number" value="3"></td><td class="webkit-line-content"><span class="webkit-html-comment"><br></span></td></tr><tr><td class="webkit-line-number" value="4"></td><td class="webkit-line-content"><span class="webkit-html-comment">Licensed under the Apache License, Version 2.0 (the "License");</span></td></tr><tr><td class="webkit-line-number" value="5"></td><td class="webkit-line-content"><span class="webkit-html-comment">you may not use this file except in compliance with the License.</span></td></tr><tr><td class="webkit-line-number" value="6"></td><td class="webkit-line-content"><span class="webkit-html-comment">You may obtain a copy of the License at</span></td></tr><tr><td class="webkit-line-number" value="7"></td><td class="webkit-line-content"><span class="webkit-html-comment"><br></span></td></tr><tr><td class="webkit-line-number" value="8"></td><td class="webkit-line-content"><span class="webkit-html-comment">    http://www.apache.org/licenses/LICENSE-2.0</span></td></tr><tr><td class="webkit-line-number" value="9"></td><td class="webkit-line-content"><span class="webkit-html-comment"><br></span></td></tr><tr><td class="webkit-line-number" value="10"></td><td class="webkit-line-content"><span class="webkit-html-comment">Unless required by applicable law or agreed to in writing, software</span></td></tr><tr><td class="webkit-line-number" value="11"></td><td class="webkit-line-content"><span class="webkit-html-comment">distributed under the License is distributed on an "AS IS" BASIS,</span></td></tr><tr><td class="webkit-line-number" value="12"></td><td class="webkit-line-content"><span class="webkit-html-comment">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></td></tr><tr><td class="webkit-line-number" value="13"></td><td class="webkit-line-content"><span class="webkit-html-comment">See the License for the specific language governing permissions and</span></td></tr><tr><td class="webkit-line-number" value="14"></td><td class="webkit-line-content"><span class="webkit-html-comment">limitations under the License.</span></td></tr><tr><td class="webkit-line-number" value="15"></td><td class="webkit-line-content"><span class="webkit-html-comment">--&gt;</span></td></tr><tr><td class="webkit-line-number" value="16"></td><td class="webkit-line-content"><span class="webkit-html-doctype">&lt;!DOCTYPE html&gt;</span></td></tr><tr><td class="webkit-line-number" value="17"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;html&gt;</span></td></tr><tr><td class="webkit-line-number" value="18"></td><td class="webkit-line-content">  <span class="webkit-html-tag">&lt;head&gt;</span></td></tr><tr><td class="webkit-line-number" value="19"></td><td class="webkit-line-content"><span class="webkit-html-comment">&lt;!--</span></td></tr><tr><td class="webkit-line-number" value="20"></td><td class="webkit-line-content"><span class="webkit-html-comment">It's important to know that Chromecast defaults to a black background with black</span></td></tr><tr><td class="webkit-line-number" value="21"></td><td class="webkit-line-content"><span class="webkit-html-comment">text.</span></td></tr><tr><td class="webkit-line-number" value="22"></td><td class="webkit-line-content"><span class="webkit-html-comment"><br></span></td></tr><tr><td class="webkit-line-number" value="23"></td><td class="webkit-line-content"><span class="webkit-html-comment">We find that having everything fit in the HTML boxes tends to look nicer on TV</span></td></tr><tr><td class="webkit-line-number" value="24"></td><td class="webkit-line-content"><span class="webkit-html-comment">so, we also set overflow: hidden, which clips all flowing outside of boxes or</span></td></tr><tr><td class="webkit-line-number" value="25"></td><td class="webkit-line-content"><span class="webkit-html-comment">adding of scrollbars, which aren't useful on TV.</span></td></tr><tr><td class="webkit-line-number" value="26"></td><td class="webkit-line-content"><span class="webkit-html-comment">--&gt;</span></td></tr><tr><td class="webkit-line-number" value="27"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;style <span class="webkit-html-attribute-name">type</span>="<span class="webkit-html-attribute-value">text/css</span>"&gt;</span></td></tr><tr><td class="webkit-line-number" value="28"></td><td class="webkit-line-content">  @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700);</td></tr><tr><td class="webkit-line-number" value="29"></td><td class="webkit-line-content">  body {</td></tr><tr><td class="webkit-line-number" value="30"></td><td class="webkit-line-content">    font-family: "Droid Serif", serif;</td></tr><tr><td class="webkit-line-number" value="31"></td><td class="webkit-line-content">    color: #444;</td></tr><tr><td class="webkit-line-number" value="32"></td><td class="webkit-line-content">    line-height: 150%;</td></tr><tr><td class="webkit-line-number" value="33"></td><td class="webkit-line-content">    border: 0px;</td></tr><tr><td class="webkit-line-number" value="34"></td><td class="webkit-line-content">    margin: 0px;</td></tr><tr><td class="webkit-line-number" value="35"></td><td class="webkit-line-content">    width: 100%;</td></tr><tr><td class="webkit-line-number" value="36"></td><td class="webkit-line-content">    height: 100%;</td></tr><tr><td class="webkit-line-number" value="37"></td><td class="webkit-line-content">    overflow: hidden !important;</td></tr><tr><td class="webkit-line-number" value="38"></td><td class="webkit-line-content">  }</td></tr><tr><td class="webkit-line-number" value="39"></td><td class="webkit-line-content">  video {</td></tr><tr><td class="webkit-line-number" value="40"></td><td class="webkit-line-content">    width: 100%;</td></tr><tr><td class="webkit-line-number" value="41"></td><td class="webkit-line-content">    height: 100%;</td></tr><tr><td class="webkit-line-number" value="42"></td><td class="webkit-line-content">    margin: auto auto;</td></tr><tr><td class="webkit-line-number" value="43"></td><td class="webkit-line-content">    overflow: hidden !important;</td></tr><tr><td class="webkit-line-number" value="44"></td><td class="webkit-line-content">  }</td></tr><tr><td class="webkit-line-number" value="45"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/style&gt;</span></td></tr><tr><td class="webkit-line-number" value="46"></td><td class="webkit-line-content">    <span class="webkit-html-tag">&lt;title&gt;</span>Media Player Library Demo<span class="webkit-html-tag">&lt;/title&gt;</span></td></tr><tr><td class="webkit-line-number" value="47"></td><td class="webkit-line-content">  <span class="webkit-html-tag">&lt;/head&gt;</span></td></tr><tr><td class="webkit-line-number" value="48"></td><td class="webkit-line-content">  <span class="webkit-html-tag">&lt;body&gt;</span></td></tr><tr><td class="webkit-line-number" value="49"></td><td class="webkit-line-content">    <span class="webkit-html-tag">&lt;video <span class="webkit-html-attribute-name">id</span>='<span class="webkit-html-attribute-value">vid</span>' /&gt;</span></td></tr><tr><td class="webkit-line-number" value="50"></td><td class="webkit-line-content"><span class="webkit-html-comment">&lt;!-- The Receiver Library - Very important use our URL, don't attempt to</span></td></tr><tr><td class="webkit-line-number" value="51"></td><td class="webkit-line-content"><span class="webkit-html-comment">host this yourself. --&gt;</span></td></tr><tr><td class="webkit-line-number" value="52"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">type</span>="<span class="webkit-html-attribute-value">text/javascript</span>"</span></td></tr><tr><td class="webkit-line-number" value="53"></td><td class="webkit-line-content">    <span class="webkit-html-attribute-name">src</span>="<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://www.gstatic.com/cast/sdk/libs/receiver/2.0.0/cast_receiver.js">http://www.gstatic.com/cast/sdk/libs/receiver/2.0.0/cast_receiver.js</a>"&gt;</td></tr><tr><td class="webkit-line-number" value="54"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number" value="55"></td><td class="webkit-line-content"><span class="webkit-html-comment">&lt;!-- The Media Player Library - use our URL, don't attempt to host this yourself</span></td></tr><tr><td class="webkit-line-number" value="56"></td><td class="webkit-line-content"><span class="webkit-html-comment">--&gt;</span></td></tr><tr><td class="webkit-line-number" value="57"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">type</span>="<span class="webkit-html-attribute-value">text/javascript</span>"</span></td></tr><tr><td class="webkit-line-number" value="58"></td><td class="webkit-line-content">    <span class="webkit-html-attribute-name">src</span>="<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://www.gstatic.com/cast/sdk/libs/mediaplayer/0.3.0/media_player.js">http://www.gstatic.com/cast/sdk/libs/mediaplayer/0.3.0/media_player.js</a>"&gt;</td></tr><tr><td class="webkit-line-number" value="59"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number" value="60"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number" value="61"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">type</span>="<span class="webkit-html-attribute-value">text/javascript</span>"&gt;</span></td></tr><tr><td class="webkit-line-number" value="62"></td><td class="webkit-line-content">window.onload = function() {</td></tr><tr><td class="webkit-line-number" value="63"></td><td class="webkit-line-content">// If you set ?Debug=true in the URL, such as a different App ID in the</td></tr><tr><td class="webkit-line-number" value="64"></td><td class="webkit-line-content">// developer console, include debugging information.</td></tr><tr><td class="webkit-line-number" value="65"></td><td class="webkit-line-content">  if (window.location.href.indexOf('Debug=true') != -1) {</td></tr><tr><td class="webkit-line-number" value="66"></td><td class="webkit-line-content">    cast.receiver.logger.setLevelValue(cast.receiver.LoggerLevel.DEBUG);</td></tr><tr><td class="webkit-line-number" value="67"></td><td class="webkit-line-content">  }</td></tr><tr><td class="webkit-line-number" value="68"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number" value="69"></td><td class="webkit-line-content">  var mediaElement = document.getElementById('vid');</td></tr><tr><td class="webkit-line-number" value="70"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number" value="71"></td><td class="webkit-line-content">// Create the media manager. This will handle all media messages by default.</td></tr><tr><td class="webkit-line-number" value="72"></td><td class="webkit-line-content">  window.mediaManager = new cast.receiver.MediaManager(mediaElement);</td></tr><tr><td class="webkit-line-number" value="73"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number" value="74"></td><td class="webkit-line-content">// Remember the default value for the Receiver onLoad, so this sample can Play</td></tr><tr><td class="webkit-line-number" value="75"></td><td class="webkit-line-content">// non-adaptive media as well.  </td></tr><tr><td class="webkit-line-number" value="76"></td><td class="webkit-line-content">  window.defaultOnLoad = mediaManager.onLoad;</td></tr><tr><td class="webkit-line-number" value="77"></td><td class="webkit-line-content">  mediaManager.onLoad = function (event) {</td></tr><tr><td class="webkit-line-number" value="78"></td><td class="webkit-line-content">// The Media Player Library requires that you call player unload between</td></tr><tr><td class="webkit-line-number" value="79"></td><td class="webkit-line-content">// different invocations.</td></tr><tr><td class="webkit-line-number" value="80"></td><td class="webkit-line-content">    if (window.player !== null) {</td></tr><tr><td class="webkit-line-number" value="81"></td><td class="webkit-line-content">      player.unload();    // Must unload before starting again.</td></tr><tr><td class="webkit-line-number" value="82"></td><td class="webkit-line-content">      window.player = null;</td></tr><tr><td class="webkit-line-number" value="83"></td><td class="webkit-line-content">    }</td></tr><tr><td class="webkit-line-number" value="84"></td><td class="webkit-line-content">// This trivial parser is by no means best practice, it shows how to access</td></tr><tr><td class="webkit-line-number" value="85"></td><td class="webkit-line-content">// event data, and uses the a string search of the suffix, rather than looking</td></tr><tr><td class="webkit-line-number" value="86"></td><td class="webkit-line-content">// at the MIME type which would be better.  In practice, you will know what</td></tr><tr><td class="webkit-line-number" value="87"></td><td class="webkit-line-content">// content you are serving while writing your player.</td></tr><tr><td class="webkit-line-number" value="88"></td><td class="webkit-line-content">    if (event.data['media'] &amp;&amp; event.data['media']['contentId']) {</td></tr><tr><td class="webkit-line-number" value="89"></td><td class="webkit-line-content">      console.log('Starting media application');</td></tr><tr><td class="webkit-line-number" value="90"></td><td class="webkit-line-content">      var url = event.data['media']['contentId'];</td></tr><tr><td class="webkit-line-number" value="91"></td><td class="webkit-line-content">// Create the Host - much of your interaction with the library uses the Host and</td></tr><tr><td class="webkit-line-number" value="92"></td><td class="webkit-line-content">// methods you provide to it. </td></tr><tr><td class="webkit-line-number" value="93"></td><td class="webkit-line-content">      window.host = new cast.player.api.Host(</td></tr><tr><td class="webkit-line-number" value="94"></td><td class="webkit-line-content">        {'mediaElement':mediaElement, 'url':url});</td></tr><tr><td class="webkit-line-number" value="95"></td><td class="webkit-line-content">      var ext = url.substring(url.lastIndexOf('.'), url.length);</td></tr><tr><td class="webkit-line-number" value="96"></td><td class="webkit-line-content">      var initStart = event.data['media']['currentTime'] || 0;</td></tr><tr><td class="webkit-line-number" value="97"></td><td class="webkit-line-content">      var autoplay = event.data['autoplay'] || true;</td></tr><tr><td class="webkit-line-number" value="98"></td><td class="webkit-line-content">      var protocol = null;</td></tr><tr><td class="webkit-line-number" value="99"></td><td class="webkit-line-content">      mediaElement.autoplay = autoplay;  // Make sure autoplay get's set</td></tr><tr><td class="webkit-line-number" value="100"></td><td class="webkit-line-content">      if (url.lastIndexOf('.m3u8') &gt;= 0) {</td></tr><tr><td class="webkit-line-number" value="101"></td><td class="webkit-line-content">// HTTP Live Streaming</td></tr><tr><td class="webkit-line-number" value="102"></td><td class="webkit-line-content">        protocol = cast.player.api.CreateHlsStreamingProtocol(host);</td></tr><tr><td class="webkit-line-number" value="103"></td><td class="webkit-line-content">      } else if (url.lastIndexOf('.mpd') &gt;= 0) {</td></tr><tr><td class="webkit-line-number" value="104"></td><td class="webkit-line-content">// MPEG-DASH</td></tr><tr><td class="webkit-line-number" value="105"></td><td class="webkit-line-content">        protocol = cast.player.api.CreateDashStreamingProtocol(host);</td></tr><tr><td class="webkit-line-number" value="106"></td><td class="webkit-line-content">      } else if (url.indexOf('.ism/') &gt;= 0) {</td></tr><tr><td class="webkit-line-number" value="107"></td><td class="webkit-line-content">// Smooth Streaming</td></tr><tr><td class="webkit-line-number" value="108"></td><td class="webkit-line-content">        protocol = cast.player.api.CreateSmoothStreamingProtocol(host);</td></tr><tr><td class="webkit-line-number" value="109"></td><td class="webkit-line-content">      }</td></tr><tr><td class="webkit-line-number" value="110"></td><td class="webkit-line-content">// How to override a method in Host. I know that it's safe to just provide this</td></tr><tr><td class="webkit-line-number" value="111"></td><td class="webkit-line-content">// method.</td></tr><tr><td class="webkit-line-number" value="112"></td><td class="webkit-line-content">      host.onError = function(errorCode) {</td></tr><tr><td class="webkit-line-number" value="113"></td><td class="webkit-line-content">        console.log("Fatal Error - "+errorCode);</td></tr><tr><td class="webkit-line-number" value="114"></td><td class="webkit-line-content">        window.player.unload();</td></tr><tr><td class="webkit-line-number" value="115"></td><td class="webkit-line-content">      };</td></tr><tr><td class="webkit-line-number" value="116"></td><td class="webkit-line-content">// If you need cookies, then set withCredentials = true also set any header</td></tr><tr><td class="webkit-line-number" value="117"></td><td class="webkit-line-content">// information you need.  If you don't need them, there can be some unexpected</td></tr><tr><td class="webkit-line-number" value="118"></td><td class="webkit-line-content">// effects by setting this value.</td></tr><tr><td class="webkit-line-number" value="119"></td><td class="webkit-line-content">//      host.updateSegmentRequestInfo = function(requestInfo) {</td></tr><tr><td class="webkit-line-number" value="120"></td><td class="webkit-line-content">//        requestInfo.withCredentials = true;</td></tr><tr><td class="webkit-line-number" value="121"></td><td class="webkit-line-content">//      };</td></tr><tr><td class="webkit-line-number" value="122"></td><td class="webkit-line-content">      console.log("we have protocol "+ext);</td></tr><tr><td class="webkit-line-number" value="123"></td><td class="webkit-line-content">      if (protocol !== null) {</td></tr><tr><td class="webkit-line-number" value="124"></td><td class="webkit-line-content">        console.log("Starting Media Player Library");</td></tr><tr><td class="webkit-line-number" value="125"></td><td class="webkit-line-content">        window.player = new cast.player.api.Player(host);</td></tr><tr><td class="webkit-line-number" value="126"></td><td class="webkit-line-content">        window.player.load(protocol, initStart);</td></tr><tr><td class="webkit-line-number" value="127"></td><td class="webkit-line-content">      }</td></tr><tr><td class="webkit-line-number" value="128"></td><td class="webkit-line-content">      else {</td></tr><tr><td class="webkit-line-number" value="129"></td><td class="webkit-line-content">        window.defaultOnLoad(event);    // do the default process</td></tr><tr><td class="webkit-line-number" value="130"></td><td class="webkit-line-content">      }</td></tr><tr><td class="webkit-line-number" value="131"></td><td class="webkit-line-content">    }</td></tr><tr><td class="webkit-line-number" value="132"></td><td class="webkit-line-content">  }</td></tr><tr><td class="webkit-line-number" value="133"></td><td class="webkit-line-content">  window.player = null;</td></tr><tr><td class="webkit-line-number" value="134"></td><td class="webkit-line-content">  console.log('Application is ready, starting system');</td></tr><tr><td class="webkit-line-number" value="135"></td><td class="webkit-line-content">  window.castReceiverManager = cast.receiver.CastReceiverManager.getInstance();</td></tr><tr><td class="webkit-line-number" value="136"></td><td class="webkit-line-content">  castReceiverManager.start();</td></tr><tr><td class="webkit-line-number" value="137"></td><td class="webkit-line-content">};</td></tr><tr><td class="webkit-line-number" value="138"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/script&gt;</span></td></tr><tr><td class="webkit-line-number" value="139"></td><td class="webkit-line-content">  <span class="webkit-html-tag">&lt;/body&gt;</span></td></tr><tr><td class="webkit-line-number" value="140"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/html&gt;</span></td></tr><tr><td class="webkit-line-number" value="141"></td><td class="webkit-line-content"><br></td></tr><tr><td class="webkit-line-number" value="142"></td><td class="webkit-line-content"><span class="webkit-html-end-of-file"></span></td></tr></tbody></table></body></html>